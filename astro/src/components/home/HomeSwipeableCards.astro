---
// HomeSwipeableCards.astro
---

<section class="py-16 bg-gray-50">
  <div class="container mx-auto px-4">
    <div class="text-center mb-12">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
        Specialised Pain Relief
      </h2>
      <p class="text-lg text-gray-600 max-w-2xl mx-auto">
        Targeted treatments for specific pain conditions with proven results
      </p>
    </div>

    <!-- Desktop Grid Layout -->
    <div class="hidden md:grid md:grid-cols-5 gap-6 w-full">
      <!-- Spine Pain Card -->
      <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
        <div class="p-8 flex flex-col justify-between items-start h-full">
          <h3 class="text-2xl font-bold text-gray-900 mb-4">Fix Spine Pain</h3>
          <p class="text-gray-600 mb-6 leading-relaxed">
            Get back your spinal health and enjoy non-surgical relief from lower back pain, chronic spinal discomfort, and posture-related stiffness. Fix spine alignment, relieve pain, improve movement and prevent further discomfort.
          </p>
          <a href="/spine-pain/" class="inline-block px-6 py-3 bg-custom-pink text-white font-semibold rounded hover:bg-custom-purple transition-colors duration-300">
            Fix Spine Pain
          </a>
        </div>
      </div>

      <!-- Shoulder Pain Card -->
      <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
        <div class="p-8 flex flex-col justify-between items-start h-full">
          <h3 class="text-2xl font-bold text-gray-900 mb-4">Fix Shoulder Pain</h3>
          <p class="text-gray-600 mb-6 leading-relaxed">
            Get a complete examination to find the source of your shoulder pain, including posture correction, range of motion assessment, and muscle strength evaluation to help permanently fix shoulder pain.
          </p>
          <a href="/shoulder-pain/" class="inline-block px-6 py-3 bg-custom-pink text-white font-semibold rounded hover:bg-custom-purple transition-colors duration-300">
            Fix Shoulder Pain
          </a>
        </div>
      </div>

      <!-- Disc Pain Card -->
      <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
        <div class="p-8 flex flex-col justify-between items-start h-full">
          <h3 class="text-2xl font-bold text-gray-900 mb-4">Fix Disc Pain</h3>
          <p class="text-gray-600 mb-6 leading-relaxed">
            Get effective disc pain treatment options that can provide significant relief without resorting to invasive procedures or heavy reliance on medication. We address root causes to regain your comfort and functionality.
          </p>
          <a href="/disc-pain/" class="inline-block px-6 py-3 bg-custom-pink text-white font-semibold rounded hover:bg-custom-purple transition-colors duration-300">
            Fix Disc Pain
          </a>
        </div>
      </div>

      <!-- Neck Pain Card -->
      <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
        <div class="p-8 flex flex-col justify-between items-start h-full">
          <h3 class="text-2xl font-bold text-gray-900 mb-4">Fix Neck Pain</h3>
          <p class="text-gray-600 mb-6 leading-relaxed">
            Reduce neck tension and restore comfortable movement with targeted chiropractic care and posture guidance.
          </p>
          <a href="/neck-pain/" class="inline-block px-6 py-3 bg-custom-pink text-white font-semibold rounded hover:bg-custom-purple transition-colors duration-300">
            Fix Neck Pain
          </a>
        </div>
      </div>

      <!-- Back Pain Card -->
      <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
        <div class="p-8 flex flex-col justify-between items-start h-full">
          <h3 class="text-2xl font-bold text-gray-900 mb-4">Fix Back Pain</h3>
          <p class="text-gray-600 mb-6 leading-relaxed">
            Improve alignment, ease muscle tension, and move freely with gentle, non-surgical back pain care.
          </p>
          <a href="/back-pain/" class="inline-block px-6 py-3 bg-custom-pink text-white font-semibold rounded hover:bg-custom-purple transition-colors duration-300">
            Fix Back Pain
          </a>
        </div>
      </div>
    </div>

    <!-- Mobile Swipeable Cards -->
    <div class="md:hidden">
      <div class="swipeable-cards-container relative overflow-hidden">
        <div class="swipeable-cards-wrapper flex transition-transform duration-300 ease-in-out" id="swipeableCards">
          <!-- Spine Pain Card -->
          <div class="swipeable-card flex-shrink-0 w-full px-4">
            <div class="bg-white rounded-lg shadow-lg overflow-hidden">
              <div class="p-6 flex flex-col justify-between items-start h-full">
                <h3 class="text-xl font-bold text-gray-900 mb-3">Fix Spine Pain</h3>
                <p class="text-gray-600 mb-4 leading-relaxed text-sm">
                  Get back your spinal health and enjoy non-surgical relief from lower back pain, chronic spinal discomfort, and posture-related stiffness. Fix spine alignment, relieve pain, improve movement and prevent further discomfort.
                </p>
                <a href="/spine-pain/" class="inline-block px-4 py-2 bg-custom-pink text-white font-semibold rounded hover:bg-custom-purple transition-colors duration-300 text-sm">
                  Fix Spine Pain
                </a>
              </div>
            </div>
          </div>

          <!-- Shoulder Pain Card -->
          <div class="swipeable-card flex-shrink-0 w-full px-4">
            <div class="bg-white rounded-lg shadow-lg overflow-hidden">
              <div class="p-6 flex flex-col justify-between items-start h-full">
                <h3 class="text-xl font-bold text-gray-900 mb-3">Fix Shoulder Pain</h3>
                <p class="text-gray-600 mb-4 leading-relaxed text-sm">
                  Get a complete examination to find the source of your shoulder pain, including posture correction, range of motion assessment, and muscle strength evaluation to help permanently fix shoulder pain.
                </p>
                <a href="/shoulder-pain/" class="inline-block px-4 py-2 bg-custom-pink text-white font-semibold rounded hover:bg-custom-purple transition-colors duration-300 text-sm">
                  Fix Shoulder Pain
                </a>
              </div>
            </div>
          </div>

          <!-- Disc Pain Card -->
          <div class="swipeable-card flex-shrink-0 w-full px-4">
            <div class="bg-white rounded-lg shadow-lg overflow-hidden">
              <div class="p-6 flex flex-col justify-between items-start h-full">
                <h3 class="text-xl font-bold text-gray-900 mb-3">Fix Disc Pain</h3>
                <p class="text-gray-600 mb-4 leading-relaxed text-sm">
                  Get effective disc pain treatment options that can provide significant relief without resorting to invasive procedures or heavy reliance on medication. We address root causes to regain your comfort and functionality.
                </p>
                <a href="/disc-pain/" class="inline-block px-4 py-2 bg-custom-pink text-white font-semibold rounded hover:bg-custom-purple transition-colors duration-300 text-sm">
                  Fix Disc Pain
                </a>
              </div>
            </div>
          </div>

          <!-- Neck Pain Card -->
          <div class="swipeable-card flex-shrink-0 w-full px-4">
            <div class="bg-white rounded-lg shadow-lg overflow-hidden">
              <div class="p-6 flex flex-col justify-between items-start h-full">
                <h3 class="text-xl font-bold text-gray-900 mb-3">Fix Neck Pain</h3>
                <p class="text-gray-600 mb-4 leading-relaxed text-sm">
                  Reduce neck tension and restore comfortable movement with targeted chiropractic care and posture guidance.
                </p>
                <a href="/neck-pain/" class="inline-block px-4 py-2 bg-custom-pink text-white font-semibold rounded hover:bg-custom-purple transition-colors duration-300 text-sm">
                  Fix Neck Pain
                </a>
              </div>
            </div>
          </div>

          <!-- Back Pain Card -->
          <div class="swipeable-card flex-shrink-0 w-full px-4">
            <div class="bg-white rounded-lg shadow-lg overflow-hidden">
              <div class="p-6 flex flex-col justify-between items-start h-full">
                <h3 class="text-xl font-bold text-gray-900 mb-3">Fix Back Pain</h3>
                <p class="text-gray-600 mb-4 leading-relaxed text-sm">
                  Improve alignment, ease muscle tension, and move freely with gentle, non-surgical back pain care.
                </p>
                <a href="/back-pain/" class="inline-block px-4 py-2 bg-custom-pink text-white font-semibold rounded hover:bg-custom-purple transition-colors duration-300 text-sm">
                  Fix Back Pain
                </a>
              </div>
            </div>
          </div>
        </div>

        <!-- Arrow Controls removed -->

        <!-- Navigation Dots -->
        <div class="flex justify-center mt-6 space-x-3" role="tablist" aria-label="Pain relief treatment cards">
          <button 
            class="w-3 h-3 rounded-full bg-custom-pink opacity-100 transition-opacity duration-300 p-2 touch-manipulation" 
            data-slide="0" 
            onclick="goToSlide(0)"
            aria-label="Go to spine pain treatment card"
            aria-selected="true"
            role="tab"
          ></button>
          <button 
            class="w-3 h-3 rounded-full bg-gray-300 opacity-50 transition-opacity duration-300 p-2 touch-manipulation" 
            data-slide="1" 
            onclick="goToSlide(1)"
            aria-label="Go to shoulder pain treatment card"
            aria-selected="false"
            role="tab"
          ></button>
          <button 
            class="w-3 h-3 rounded-full bg-gray-300 opacity-50 transition-opacity duration-300 p-2 touch-manipulation" 
            data-slide="2" 
            onclick="goToSlide(2)"
            aria-label="Go to disc pain treatment card"
            aria-selected="false"
            role="tab"
          ></button>
          <button 
            class="w-3 h-3 rounded-full bg-gray-300 opacity-50 transition-opacity duration-300 p-2 touch-manipulation" 
            data-slide="3" 
            onclick="goToSlide(3)"
            aria-label="Go to neck pain treatment card"
            aria-selected="false"
            role="tab"
          ></button>
          <button 
            class="w-3 h-3 rounded-full bg-gray-300 opacity-50 transition-opacity duration-300 p-2 touch-manipulation" 
            data-slide="4" 
            onclick="goToSlide(4)"
            aria-label="Go to back pain treatment card"
            aria-selected="false"
            role="tab"
          ></button>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // Swipeable cards functionality
  let currentSlide = 0;
  const totalSlides = 5;
  const slideWidthPercent = 100 / totalSlides; // percent of wrapper width per slide
  let startX = 0;
  let currentX = 0;
  let isDragging = false;

  const wrapper = document.getElementById('swipeableCards');
  const dots = document.querySelectorAll('[data-slide]');
  // arrow buttons removed

  // --- Helper functions available globally ---
  function updateSlide() {
    if (!wrapper) return;
    wrapper.style.transform = `translateX(-${currentSlide * slideWidthPercent}%)`;
    updateDots();
  }

  function updateDots() {
    dots.forEach((dot, index) => {
      if (index === currentSlide) {
        dot.classList.remove('bg-gray-300', 'opacity-50');
        dot.classList.add('bg-custom-pink', 'opacity-100');
        dot.setAttribute('aria-selected', 'true');
      } else {
        dot.classList.remove('bg-custom-pink', 'opacity-100');
        dot.classList.add('bg-gray-300', 'opacity-50');
        dot.setAttribute('aria-selected', 'false');
      }
    });
  }

  if (wrapper) {
    // Touch events
    wrapper.addEventListener('touchstart', handleTouchStart, { passive: false });
    wrapper.addEventListener('touchmove', handleTouchMove, { passive: false });
    wrapper.addEventListener('touchend', handleTouchEnd, { passive: false });

    // Mouse events for desktop testing
    wrapper.addEventListener('mousedown', handleMouseDown, { passive: true });
    wrapper.addEventListener('mousemove', handleMouseMove, { passive: true });
    wrapper.addEventListener('mouseup', handleMouseUp, { passive: true });
    wrapper.addEventListener('mouseleave', handleMouseUp, { passive: true });

    function handleTouchStart(e) {
      startX = e.touches[0].clientX;
      isDragging = true;
    }

    function handleTouchMove(e) {
      if (!isDragging) return;
      e.preventDefault();
      currentX = e.touches[0].clientX;
      const diff = currentX - startX;
      const translateX = -currentSlide * slideWidthPercent + (diff / wrapper.offsetWidth) * 100;
      wrapper.style.transform = `translateX(${translateX}%)`;
    }

    function handleTouchEnd() {
      if (!isDragging) return;
      isDragging = false;
      const diff = currentX - startX;
      const threshold = (wrapper.offsetWidth / totalSlides) * 0.3;

      if (Math.abs(diff) > threshold) {
        if (diff > 0 && currentSlide > 0) {
          currentSlide--;
        } else if (diff < 0 && currentSlide < totalSlides - 1) {
          currentSlide++;
        }
      }

      updateSlide();
    }

    function handleMouseDown(e) {
      startX = e.clientX;
      isDragging = true;
      wrapper.style.cursor = 'grabbing';
    }

    function handleMouseMove(e) {
      if (!isDragging) return;
      currentX = e.clientX;
      const diff = currentX - startX;
      const translateX = -currentSlide * slideWidthPercent + (diff / wrapper.offsetWidth) * 100;
      wrapper.style.transform = `translateX(${translateX}%)`;
    }

    function handleMouseUp() {
      if (!isDragging) return;
      isDragging = false;
      wrapper.style.cursor = 'grab';
      const diff = currentX - startX;
      const threshold = (wrapper.offsetWidth / totalSlides) * 0.3;

      if (Math.abs(diff) > threshold) {
        if (diff > 0 && currentSlide > 0) {
          currentSlide--;
        } else if (diff < 0 && currentSlide < totalSlides - 1) {
          currentSlide++;
        }
      }

      updateSlide();
    }

    // Auto-advance slides every 5 seconds
    setInterval(() => {
      currentSlide = (currentSlide + 1) % totalSlides;
      updateSlide();
    }, 5000);
  }

  // Function to go to specific slide
  function goToSlide(slideIndex) {
    currentSlide = slideIndex;
    updateSlide();
  }
</script>

<style>
  .swipeable-cards-container {
    max-width: 100%;
  }
  
  .swipeable-cards-wrapper {
    width: 500%;
    touch-action: pan-y;
  }
  
  .swipeable-card {
    width: 20%;
  }
  
  @media (max-width: 768px) {
    .swipeable-cards-wrapper {
      cursor: grab;
    }
    
    .swipeable-cards-wrapper:active {
      cursor: grabbing;
    }
  }
</style> 