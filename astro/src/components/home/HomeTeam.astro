---
import UnderlinedHeader from "../UnderlinedHeader.astro";
import PrimaryButton from "../PrimaryButton.astro";
import ScrollCrop from "../ScrollCrop.astro";
import personalPlan from "/public/Personal-Plan-img.webp";
import hooman from "/public/team/hooman.webp";
import angus from "/public/team/angus.png.webp";
import rebecca from "/public/team/reb.webp";
import rin from "/public/team/woman.webp";
import roberto from "/public/team/rob.png.webp";
import christine from "/public/team/random1.jpg.webp";
import emma from "/public/team/random2.jpg.webp";


const doctors = [
    {
        name: "Dr. Hooman Zahedi",
        image: hooman.src,
        description: "Chiropractor"
    },
    {
        name: "Dr. Angus Phelps",
        image: angus.src,
        description: "Chiropractor"
    },
    {
        name: "Dr. Rebecca Squire",
        image: rebecca.src,
        description: "Chiropractor"
    },
    {
        name: "Dr Rin Choi",
        image: rin.src,
        description: "Chiropractor"
    },
]

const assistant = [
    {
        name: "Roberto Vita",
        image: roberto.src,
        description: "Massage Therapist"
    },
    {
        name: "Christine Clark",
        image: christine.src,
        description: "Chiropractic Assistant"
    },
    {
        name: "Emma Muir",
        image: emma.src,
        description: "Chiropractic Assistant"
    },
]

---
<div class="w-full py-20">
    <div class="mx-auto container">
        <div class="text-center mb-16">
            <UnderlinedHeader>
                Meet Your Sydney CBD Chiropractors
            </UnderlinedHeader>
        </div>

        <!-- Doctors Grid - Desktop -->
        <div class="hidden md:grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16">
            {doctors.map((doctor) => (
                <div class="flex flex-col items-center">
                    <div class="w-40 h-40 md:w-52 md:h-52 mb-4 overflow-hidden rounded-full">
                        <img src={doctor.image} alt={doctor.name} class="w-full h-full object-cover" />
                    </div>
                    <h3 class="text-xl font-semibold mb-1 text-custom-purple">{doctor.name}</h3>
                    <p class="text-gray-600">{doctor.description}</p>
                </div>
            ))}
        </div>

        <!-- Doctors Grid - Mobile -->
        <div class="grid md:hidden grid-cols-1 gap-8 mb-16">
            {doctors.map((doctor) => (
                <div class="flex flex-col items-center">
                    <div class="w-48 h-48 mb-4 overflow-hidden rounded-full">
                        <img src={doctor.image} alt={doctor.name} class="w-full h-full object-cover" />
                    </div>
                    <h3 class="text-xl font-semibold mb-1 text-custom-purple">{doctor.name}</h3>
                    <p class="text-gray-600">{doctor.description}</p>
                </div>
            ))}
        </div>

        <!-- Assistants Grid - Desktop -->
        <div class="hidden md:grid grid-cols-1 md:grid-cols-3 gap-8">
            {assistant.map((person) => (
                <div class="flex flex-col items-center">
                    <div class="w-48 h-48 md:w-72 md:h-72 mb-4 overflow-hidden rounded-full">
                        <img src={person.image} alt={person.name} class="w-full h-full object-cover" />
                    </div>
                    <h3 class="text-xl font-semibold mb-1 text-custom-purple">{person.name}</h3>
                    <p class="text-gray-600">{person.description}</p>
                </div>
            ))}
        </div>

        <!-- Assistants Grid - Mobile -->
        <div class="grid md:hidden grid-cols-1 gap-8">
            {assistant.map((person) => (
                <div class="flex flex-col items-center">
                    <div class="w-48 h-48 mb-4 overflow-hidden rounded-full">
                        <img src={person.image} alt={person.name} class="w-full h-full object-cover" />
                    </div>
                    <h3 class="text-xl font-semibold mb-1 text-custom-purple">{person.name}</h3>
                    <p class="text-gray-600">{person.description}</p>
                </div>
            ))}
        </div>

        <div class="flex justify-center mt-10">
            <PrimaryButton href="https://clinic27intake.bookings.pracsuite.com/guest?_gl=1*ish5tk*_gcl_au*MTE4MzYwMjQ1Ny4xNzUyNDc4Mzk3*_ga*MTgyODUzMzI5Ni4xNzUyNDc4Mzk3*_ga_DVEN4QQTPM*czE3NTI0NzgzOTckbzEkZzAkdDE3NTI0NzgzOTckajYwJGwwJGgw*_ga_S36TR91H9N*czE3NTI0NzgzOTckbzEkZzAkdDE3NTI0NzgzOTckajYwJGwwJGgw*_ga_NTMX2EEDN4*czE3NTI0NzgzOTckbzEkZzAkdDE3NTI0NzgzOTckajYwJGwwJGgw*_ga_8J9DNH249S*czE3NTI0NzgzOTckbzEkZzAkdDE3NTI0NzgzOTckajYwJGwwJGgw">Book Now</PrimaryButton>
        </div>
    </div>
    
    <!-- Doctor Carousel Section -->
    <div class="mt-20 relative overflow-hidden min-h-[50vh]">
        <!-- Background layer: ScrollCrop -->
        <div class="absolute inset-0 z-0">
            <ScrollCrop src={personalPlan.src} height="100%" class="w-full h-full" />
        </div>

        <!-- Content layer: Carousel -->
        <div class="relative z-10 py-16">
            <!-- Carousel slides -->
            <div class="carousel-content">
                {doctors.map((doctor, index) => (
                    <div class="carousel-slide" id={`slide-${index}`} style={index === 0 ? "display: block;" : "display: none;"}>
                        <div class="flex flex-col items-center px-8">
                            <div class="w-52 h-52 mb-4 overflow-hidden rounded-full">
                                <img src={doctor.image} alt={doctor.name} class="w-full h-full object-cover" />
                            </div>
                            <h3 class="text-xl font-semibold mb-1 text-white">{doctor.name}</h3>
                            <p class="text-white mb-6" style="text-transform: uppercase;">{doctor.description}</p>
                            <PrimaryButton variant="primary" href="/about-clinic27/">Learn More</PrimaryButton>
                        </div>
                    </div>
                ))}
            </div>
            
            <!-- Carousel navigation dots -->
            <div class="carousel-dots flex justify-center mt-8 space-x-3" role="tablist" aria-label="Doctor team carousel">
                {doctors.map((_, index) => (
                    <button 
                        class="carousel-dot w-4 h-4 rounded-full bg-gray-300 focus:outline-none p-2 touch-manipulation" 
                        data-slide={index}
                        aria-label={`Go to slide ${index + 1} - ${doctors[index].name}`}
                        aria-selected={index === 0 ? 'true' : 'false'}
                        role="tab"
                        data-index={index}
                        id={`dot-${index}`}
                    ></button>
                ))}
            </div>
        </div>
    </div>
</div>

<script>
    // Carousel functionality
    document.addEventListener('DOMContentLoaded', () => {
        const slides = document.querySelectorAll('.carousel-slide');
        const dots = document.querySelectorAll('.carousel-dot');
        
        // Set first slide and dot as active
        if (slides.length > 0) {
            (slides[0] as HTMLElement).style.display = 'block';
            dots[0].classList.add('bg-black');
        }
        
        // Add click event to dots
        dots.forEach((dot) => {
            dot.addEventListener('click', (e) => {
                const target = e.currentTarget as HTMLElement;
                const index = parseInt(target.getAttribute('data-index') || '0', 10);
                showSlide(index);
            });
        });
        
        // Function to show a specific slide
        function showSlide(index: number) {
            slides.forEach((slide) => {
                (slide as HTMLElement).style.display = 'none';
            });
            
            dots.forEach(dot => {
                dot.classList.remove('bg-black');
                dot.classList.add('bg-gray-300');
            });
            
            (slides[index] as HTMLElement).style.display = 'block';
            dots[index].classList.remove('bg-gray-300');
            dots[index].classList.add('bg-black');
        }
    });
</script>